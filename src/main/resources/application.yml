spring:
  application:
    name: TumblrTagTracker

  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}

  jpa:
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        show_sql: ${SHOW_SQL:false}
        format_sql: true
        use_sql_comments: false
    hibernate:
      ddl-auto: ${DDL_AUTO:update}

  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
      password: ${REDIS_PASSWORD}
      database: ${REDIS_DATABASE}
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
      timeout: 2000ms

  docker:
    compose:
      enabled: false

telegram:
  bot:
    token: ${TELEGRAM_BOT_TOKEN}
    username: ${TELEGRAM_BOT_USERNAME}

tumblr:
  api:
    key: ${TUMBLR_API_KEY}
    secret: ${TUMBLR_API_SECRET}
  filter:
    minimum:
      notes: ${MIN_NOTES}
      age:
        hours: ${MIN_AGE_HOURS}
    recheck:
      interval:
        hours: ${RECHECK_HOURS}
    cleanup:
      days: ${CLEANUP_DAYS}
  check:
    interval:
      ms: 600000
  cleanup:
    cron: 0 0 3 * * ?

notification:
  delay:
    between:
      users:
        ms: 1000

resilience4j:
  circuitbreaker:
    instances:
      tumblr:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 60s
        sliding-window-size: 10
      telegram:
        failure-rate-threshold: 50
        wait-duration-in-open-state: 30s
        sliding-window-size: 10
  retry:
    instances:
      telegram:
        max-attempts: 3
        wait-duration: 1s

logging:
  level:
    org:
      telegram: ${LOG_LEVEL:INFO}
      hibernate:
        SQL: ${LOG_LEVEL:INFO}
        type:
          descriptor:
            sql:
              BasicBinder: ${LOG_LEVEL:INFO}
    TelegramBot: ${APP_LOG_LEVEL:INFO}